---
name: gemini-cli-delegation
description: 대규모 코드 분석, 멀티모달 해석, 프로젝트 전체 파악, 리팩토링 설계 등 광범위한 작업 시 Gemini CLI를 활용하여 요약 결과를 확보하는 패턴. 많은 파일 분석, 이미지/스크린샷 해석, 아키텍처 리뷰, 보안 감사, 마이그레이션 분석, Deep Think 추론 시 사용.
---

# Gemini CLI 위임 패턴

## 1. 개요

### Gemini CLI란?
터미널에서 Google Gemini 모델에 접근하는 오픈소스 AI 에이전트. 1M 토큰 컨텍스트 윈도우와 멀티모달 처리 능력을 활용하여 많은 파일을 한번에 분석할 수 있다.

### 왜 위임하는가?
- Claude의 컨텍스트를 효율적으로 사용 (요약된 결과만 수신)
- Gemini의 **1M 토큰** 컨텍스트 윈도우를 활용한 광범위 분석 (Claude 200K의 5배)
- **멀티모달 처리** (이미지, 스크린샷, PDF 해석) — Claude Code 터미널에서 불가능한 작업
- **Deep Think 모드**로 복잡한 추론 (GPQA Diamond 93.8%)
- 분석 결과를 기반으로 Claude가 정밀한 코드 작성에 집중

### Claude 대비 Gemini 3 강점 (벤치마크 기준)

| 영역 | Gemini 3 | Claude | 차이 |
|------|---------|--------|------|
| 컨텍스트 윈도우 | **1M 토큰** | 200K 토큰 | 5배 |
| 멀티모달 (MMMU-Pro) | **81%** | 해당없음 (CLI) | Gemini 압도 |
| 사실 정확도 (SimpleQA) | **72.1%** (SOTA) | - | Gemini 우위 |
| Deep Think 추론 (GPQA) | **93.8%** | 83.3% | +10.5pp |
| 제로샷 프로토타이핑 | **빠름** | 정밀함 | 용도 상이 |
| 속도/비용 (Flash) | **3x 빠르고 60-70% 저렴** | - | Flash 우위 |
| SWE-bench Verified | 76.2-77.4% | **76.8-80.9%** | Claude 우위 |
| 정밀 코드 작성 | 보통 | **최적** | Claude 우위 |

## 2. 사전 확인

### 설치 여부 확인
```bash
# Unix/macOS
which gemini 2>/dev/null && echo "AVAILABLE" || echo "NOT_AVAILABLE"

# Windows
where gemini 2>nul && echo "AVAILABLE" || echo "NOT_AVAILABLE"
```

### 모델 선택
```bash
# 기본: 자동 라우팅 (작업 복잡도에 따라 Flash/Pro 자동 선택)
gemini "프롬프트"

# Flash 모델 강제 (빠르고 저렴, 대부분의 분석에 충분)
gemini "프롬프트" --model gemini-3-flash

# Pro 모델 강제 (더 정밀한 분석 필요 시)
gemini "프롬프트" --model gemini-3-pro
```

> **참고**: Gemini 3 Flash는 대부분의 벤치마크에서 Pro를 상회하면서 3x 빠르고 60-70% 저렴합니다. 특별한 이유 없으면 Flash 또는 자동 라우팅을 사용합니다.

### Fallback 전략
Gemini CLI 미설치 시 Claude가 직접 수행:
- Task(Explore) 에이전트로 코드베이스 탐색
- Glob/Grep 도구로 파일 검색 및 패턴 분석
- 필요 시 파일을 순차적으로 읽어 분석
- 멀티모달/Deep Think는 대체 불가 — 사용자에게 안내

## 3. 위임 판단 기준

### 대규모 분석 시나리오 (기존)

| 시나리오 | 트리거 조건 | 예시 |
|---------|-----------|------|
| 많은 파일 동시 파악 | 10개 이상 파일의 패턴/구조 분석 | "모든 API 라우터의 인증 패턴 분석해줘" |
| 프로젝트 전체 분석 | 아키텍처 파악, 의존관계 맵핑 | "프로젝트 아키텍처 전체를 설명해줘" |
| 대규모 리팩토링 설계 | 3개 이상 모듈에 영향, 10+ 파일 변경 예상 | "서비스 레이어를 CQRS 패턴으로 변경" |
| 보안 코드 리뷰 | 인증/권한/입력검증 등 다수 파일 보안 분석 | "API 엔드포인트 전체 보안 취약점 점검" |
| 마이그레이션 영향도 분석 | 라이브러리 업그레이드 시 영향 범위 파악 | "Pydantic v1->v2 마이그레이션 영향 분석" |
| 코드 품질 감사 | 프로젝트 전반의 안티패턴/중복 탐지 | "backend 전체 코드 품질 리포트 작성" |
| 테스트 커버리지 갭 분석 | 테스트 없는 비즈니스 로직 탐지 | "테스트가 없는 핵심 로직 목록 추출" |
| API 호환성 분석 | API 변경 시 클라이언트 영향도 파악 | "v2 API 변경이 프론트엔드에 미치는 영향" |
| 문서-코드 정합성 검증 | 문서와 실제 코드 불일치 탐지 | "CLAUDE.md와 실제 코드 경로 불일치 찾기" |

### 멀티모달 시나리오 (Gemini 3 신규)

| 시나리오 | 트리거 조건 | 예시 |
|---------|-----------|------|
| UI 스크린샷 → 코드 | 디자인 이미지/목업을 코드로 변환 | "이 스크린샷을 보고 React 컴포넌트 설계해줘" |
| 문서 이미지 분석 | 스캔된 문서/PDF에서 구조화된 데이터 추출 | "이 판결문 스캔본에서 주요 내용 추출해줘" |
| 다이어그램 해석 | 아키텍처 다이어그램/ERD를 코드로 | "이 ERD 이미지를 보고 ORM 모델 설계해줘" |
| 에러 스크린샷 분석 | 에러 화면 캡처에서 원인 추론 | "이 에러 화면 분석해줘 @error-screenshot.png" |

### Deep Think 추론 시나리오 (Gemini 3 신규)

| 시나리오 | 트리거 조건 | 예시 |
|---------|-----------|------|
| 복잡한 논리 관계 분석 | 판례 간 인용/모순 관계 추론 | "이 판례들의 논리적 모순점을 찾아줘" |
| 과학/수학 추론 | GPQA Diamond 수준 문제 | "이 통계 알고리즘의 수학적 정확성 검증해줘" |
| 멀티홉 추론 | 여러 단계의 연쇄 추론 필요 | "법령A→판례B→법령C 인용 체인 분석" |

### 팩트 체크 시나리오 (Gemini 3 신규)

| 시나리오 | 트리거 조건 | 예시 |
|---------|-----------|------|
| 실시간 팩트 검증 | Google Search Grounding 활용 | "이 법령이 현재도 유효한지 확인해줘" |
| 최신 정보 확인 | 법령 개정, 최신 판례 확인 | "최근 개정된 민법 조항 확인해줘" |

### 빠른 프로토타이핑 시나리오 (Gemini 3 신규)

| 시나리오 | 트리거 조건 | 예시 |
|---------|-----------|------|
| 실험적 코드 생성 | PoC, 프로토타입 빠르게 만들기 | "새 RAG 파이프라인 프로토타입 만들어줘" |
| 제로샷 기능 구현 | 명확한 요구사항의 빠른 초안 | "LanceDB 하이브리드 검색 초안 코드 생성해줘" |

> **주의**: 프로토타입은 Gemini가 빠르게 생성하고, Claude가 정제/검증하는 흐름으로 사용합니다.

### 위임하지 않는 경우
- 단일 파일 분석 또는 수정
- 5개 이하 파일에 대한 간단한 분석
- 구체적인 코드 작성 작업 (Claude가 더 정밀)
- 복잡한 멀티 파일 리팩토링 실행 (Claude가 더 정확)
- Gemini CLI 미설치 환경

## 4. 명령어 패턴

### 기본 사용법
```bash
# 기본 (비대화형, 텍스트 출력)
gemini "프롬프트 내용"

# JSON 출력 (파싱 필요 시)
gemini "프롬프트 내용" -o json

# YOLO 모드 (에이전트 동작, 파일 읽기 자동 승인)
gemini "프롬프트 내용" -y

# 샌드박스 모드 (안전한 실행)
gemini "프롬프트 내용" -s

# stdin 파이핑
cat file.py | gemini "이 코드의 보안 취약점을 분석해줘"

# 파일 참조 (@prefix)
gemini "다음 파일들의 아키텍처를 분석해줘 @backend/app/main.py @backend/app/core/registry.py"
```

### 대규모 분석 명령어

```bash
# 1. 프로젝트 구조 분석
gemini "이 프로젝트의 전체 아키텍처를 분석해줘. 주요 모듈, 의존관계, 데이터 흐름을 요약해줘." -y -o text

# 2. 다수 파일 패턴 분석
gemini "backend/app/modules/ 하위 모든 router/ 디렉토리의 공통 패턴과 차이점을 분석해줘." -y -o text

# 3. 리팩토링 영향 범위 분석
gemini "backend/app/services/ 를 분석하고, 함수 단위 리팩토링 계획을 제안해줘. 영향받는 파일 목록 포함." -y -o text

# 4. 보안 코드 리뷰
gemini "backend/app/api/ 와 backend/app/modules/ 의 API 엔드포인트 전체를 분석하고 보안 취약점을 보고해줘." -y -o text

# 5. 마이그레이션 분석
gemini "이 프로젝트에서 pydantic v1 패턴을 모두 찾고, v2로 마이그레이션할 때 변경이 필요한 부분을 리스트업해줘." -y -o text

# 6. 코드-문서 정합성 검증
gemini "CLAUDE.md에 기술된 파일 경로와 클래스명이 실제 코드와 일치하는지 검증해줘. 불일치 목록을 작성해줘." -y -o text

# 7. 테스트 갭 분석
gemini "backend/app/services/ 의 비즈니스 로직 중 테스트가 없는 함수 목록을 추출해줘." -y -o text
```

### 멀티모달 명령어 (Gemini 3 신규)

```bash
# 8. UI 스크린샷 → 컴포넌트 설계
gemini "이 스크린샷의 UI를 분석하고 React 컴포넌트 구조를 설계해줘 @screenshot.png" -o text

# 9. 문서 이미지 분석
gemini "이 법률 문서 이미지에서 조항 구조와 핵심 내용을 추출해줘 @document.png" -o text

# 10. 다이어그램 → 코드
gemini "이 ERD 다이어그램을 보고 SQLAlchemy ORM 모델을 설계해줘 @erd.png" -o text

# 11. 에러 스크린샷 분석
gemini "이 에러 화면을 분석하고 원인과 해결 방법을 제안해줘 @error.png" -o text
```

### Deep Think 명령어 (Gemini 3 신규)

```bash
# 12. 복잡한 추론 (Deep Think 모드)
gemini "다음 판례들의 논리적 관계를 분석해줘. 모순되는 판결 근거가 있는지 찾아줘." -y --deep-think

# 13. 수학/통계 검증
gemini "이 통계 알고리즘의 수학적 정확성을 검증해줘 @backend/app/services/service_function/lawyer_stats_service.py" --deep-think
```

### 팩트 체크 명령어 (Gemini 3 신규)

```bash
# 14. 실시간 법령 확인 (Google Search Grounding)
gemini "민법 제750조의 현재 조문 내용과 최근 개정 이력을 확인해줘" -y

# 15. 최신 라이브러리 정보 확인
gemini "LanceDB 최신 버전의 하이브리드 검색 API 변경사항을 확인해줘" -y
```

### 빠른 프로토타이핑 명령어 (Gemini 3 신규)

```bash
# 16. 실험적 코드 초안 생성
gemini "LanceDB에서 FTS + 벡터 검색을 결합한 하이브리드 검색 파이프라인 프로토타입을 만들어줘. Python 코드로." -y -o text

# 17. 제로샷 기능 구현 초안
gemini "FastAPI에서 WebSocket 기반 실시간 채팅 엔드포인트 초안을 작성해줘." -o text
```

## 5. 출력 활용 방법

### 기본 흐름
1. Gemini CLI로 대규모 분석 실행
2. 출력 결과를 Claude의 작업 컨텍스트로 사용
3. **Claude가 결과 검증** (파일 경로, 함수명 존재 여부 등)
4. 검증된 결과를 기반으로 구체적인 파일 읽기 및 수정 진행

### 프로토타이핑 흐름 (신규)
1. Gemini CLI로 프로토타입 코드 빠르게 생성
2. Claude가 코드 품질/보안/프로젝트 컨벤션 검증
3. Claude가 프로젝트 규칙에 맞게 정제하여 적용

### JSON 출력 파싱
```bash
# jq로 구조화된 데이터 추출
gemini "분석 결과를 JSON으로 출력해줘" -o json | jq '.results[]'
```

### 결과 저장
```bash
# 분석 결과를 파일로 저장하여 참조
gemini "프로젝트 아키텍처를 분석해줘" -y -o text > analysis_result.txt
```

## 6. 주의사항

- **검증 필수**: Gemini 출력은 반드시 Claude가 검증 (잘못된 경로, 존재하지 않는 함수 등 가능)
- **민감 정보 차단**: API 키, 비밀번호가 포함된 파일(`.env`, `credentials.json` 등)은 Gemini에 전달하지 않음
- **에러 시 fallback**: Gemini CLI가 에러를 반환하면 Claude가 직접 분석으로 전환
- **읽기 전용 분석**: `-y` (yolo) 모드는 읽기 전용 분석에만 사용, 파일 수정 작업에는 사용하지 않음
- **네트워크 의존**: Gemini CLI는 네트워크 연결 필요, 오프라인 환경에서는 Claude가 직접 수행
- **프로토타입 코드 직접 사용 금지**: Gemini가 생성한 코드는 반드시 Claude가 검증/정제 후 적용
- **Deep Think 비용**: Deep Think 모드는 일반 모드보다 토큰 소비가 크므로, 복잡한 추론이 필요한 경우에만 사용
- **Flash vs Pro**: 대부분의 작업에 Flash 모델이 충분. Pro는 매우 복잡한 분석에만 사용
